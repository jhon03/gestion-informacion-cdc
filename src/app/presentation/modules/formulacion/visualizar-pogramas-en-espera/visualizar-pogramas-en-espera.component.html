

<div *ngIf="cargando" class="spinner-container">
  <mat-spinner></mat-spinner>
</div>

<!-- Mensaje si no hay programas -->
<div *ngIf="!cargando && sinProgramas" class="mensaje-vacio">
  <mat-icon color="accent" class="icono-info">info</mat-icon>
  No hay programas en espera de ser confirmados.
</div>
<mat-card-header>
        <mat-card-title>Programas en Espera</mat-card-title>
      </mat-card-header>
<!-- si hay programas se muestra-->
<div *ngIf="!cargando && !sinProgramas">
  <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">

    <!-- Nombre del programa -->
    <ng-container matColumnDef="nombrePrograma">
      <th mat-header-cell *matHeaderCellDef> Nombre Programa </th>
      <td mat-cell *matCellDef="let programa"> {{ programa.nombrePrograma }} </td>
    </ng-container>

    <!-- Estado del programa con botón de activación -->
    <ng-container matColumnDef="estado">
      <th mat-header-cell *matHeaderCellDef> Estado </th>
      <td mat-cell *matCellDef="let programa">
        <button mat-button
                [ngClass]="{'btn-estado-activado': programa.estado === 'ACTIVADO'}"
                (click)="confirmarActivacion(programa)">
          {{ programa.estado }}
        </button>
      </td>
    </ng-container>

    <!-- Información del programa -->
    <ng-container matColumnDef="informacion">
      <th mat-header-cell *matHeaderCellDef> Información </th>
      <td mat-cell *matCellDef="let programa">
        <div class="info-programa">
        <ul class="lista-informacion">
          <li *ngFor="let info of programa.expanded ? (programa.informacion | keyvalue) : (programa.informacion | keyvalue).slice(0, 2)">

            <ng-container *ngIf="isObject(info.value); else simpleValue">
            <span class="etiqueta">{{ info.value.campo }}:</span>
            <span class="valor">{{ info.value.valor }}</span>
            </ng-container>

            <ng-template #simpleValue>
              <strong>{{ info.key }}:</strong> {{ info.value }}
              <span class="valor">{{ info.value }}</span>
            </ng-template>

          </li>
        </ul>

 <!-- Botón Ver más / Ver menos -->
     <button *ngIf="(programa.informacion | keyvalue).length > 2"
              mat-raised-button
              color="accent"
              class="btn-ver-mas texto-resaltado"
              (click)="programa.expanded = !programa.expanded">
        {{ programa.expanded ? 'Ver menos' : 'Ver más información' }}
      </button>
</div>
      </td>

</ng-container>
    <!-- Fecha de creación del programa -->
    <ng-container matColumnDef="fechaCreacion">
      <th mat-header-cell *matHeaderCellDef> Fecha Creación </th>
      <td mat-cell *matCellDef="let programa"> {{ programa.fechaCreacion }} </td>
    </ng-container>

    <!-- Renderizar las filas de la tabla -->
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

  </table>

</div>
<div class="paginacion-container" *ngIf="totalPages > 1">
  <button mat-button (click)="paginaAnterior()" [disabled]="page === 1">Anterior</button>
  <span>Página {{ page }} de {{ totalPages }}</span>
  <button mat-button (click)="siguientePagina()" [disabled]="page === totalPages">Siguiente</button>
</div>